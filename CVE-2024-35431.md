# CVE-2024-35431
###  ZKTeco ZKBio CVSecurity 6.1.1 is vulnerable to Directory Traversal via photoBase64. An unauthenticated user can download local files from the web server
### Poc 

Vulnerable parameter : path

![image](https://github.com/mrojz/ZKT-Bio-CVSecurity/assets/48892158/1964c8b9-61aa-4c64-85c1-344cd59a304e)

There are other parameters that need to be set including a signature. I created a http proxy that automatically update the field based on the file you want to download. (Download the file from [here](https://github.com/mrojz/ZKT-Bio-CVSecurity/blob/main/ZKT.py)

In order to run the script first install mitmproxy using ```pip install mitmproxy``` then run it using ```mitmdump -s ZKT.py -p 8000```

In Burp go to ```Proxy settings / Network / Connections > Upstream proxy server``` and add the mitmproxy settings 

![image](https://github.com/mrojz/ZKT-Bio-CVSecurity/assets/48892158/7cb81fd3-cb25-4cdc-8951-2a9d114cbde2)
